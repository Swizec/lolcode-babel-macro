{"version":3,"file":"lolcode-babel-macro.umd.js","sources":["../src/JSify.js","../src/lolstdlib.js","../src/macro.js"],"sourcesContent":["const stdlib = require(\"./lolstdlib\");\n\nclass JSify {\n    Assignment = (node, newIT) => {\n        return `${node.name} = ${this.compile(node.value)}`;\n    };\n\n    ArgList = (node, newIT) => {\n        return node.values.map(this.compile).join(\", \");\n    };\n\n    Body = (node, newIT) => {\n        node.lines = node.lines.map(node => this.compile(node));\n        if (newIT) {\n            node.lines.unshift(`let IT;`);\n        }\n\n        return node.lines.join(\"\\n\");\n    };\n\n    Break = (node, newIT) => {\n        return \"break;\";\n    };\n\n    Declaration = (node, newIT) => {\n        let value = \"null\";\n\n        if (node.value !== null) {\n            value = this.compile(node.value);\n        }\n\n        return `let ${node.name} = ${value};`;\n    };\n\n    FunctionCall = (node, newIT) => {\n        if (stdlib[node.name]) {\n            return `lolcode.stdlib[\"${node.name}\"](${this.compile(node.args)})`;\n        } else {\n            return `${node.name}(${this.compile(node.args)})`;\n        }\n    };\n\n    FunctionDefinition = (node, newIT) => {\n        return `function ${node.name}(${node.args.join(\", \").toLowerCase()}) {\n            ${this.compile(node.body)}\n            return IT;\n        }`;\n    };\n\n    Return = (node, newIT) => {\n        return `return ${this.compile(node.expression)}`;\n    };\n\n    Identifier = (node, newIT) => {\n        return node.name.toLowerCase();\n    };\n\n    If = (node, newIT) => {\n        let cond = node.condition;\n\n        // MEBBEs have conditions\n        // otherwise use implicit IT\n        // implementation quirk: previous expression val must be assigned to IT\n        if (cond) {\n            cond = this.compile(node.condition);\n        } else {\n            cond = \"IT\";\n        }\n\n        let code = `if (${cond}) {\n            ${this.compile(node.body)}\n        }`;\n\n        if (node.elseIfs) {\n            code += node.elseIfs\n                .map(node => `else ${this.compile(node)}`)\n                .join(\"\\n\");\n        }\n\n        if (node.elseBody) {\n            code += `else {\n                ${this.compile(node.elseBody)}\n            }`;\n        }\n\n        return code;\n    };\n\n    Gimmeh = (node, newIT) => {\n        return `${node.variable} = window.prompt()`;\n    };\n\n    Visible = (node, newIT) => {\n        return `console.log(${this.compile(node.expression)})`;\n    };\n\n    Literal = (node, newIT) => {\n        if (typeof node.value === \"string\") {\n            return `\"${node.value}\"`;\n        } else {\n            return node.value;\n        }\n    };\n\n    Loop = (node, newIT) => {\n        const cond = this.compile(node.condition);\n        const op = node.op;\n        const body = this.compile(node.body);\n\n        const incordec = op.command == \"inc\" ? \"++\" : \"--\";\n        return `for (; ${cond}; _${op.symbol}${incordec}) {\n            ${body};\n        };`;\n    };\n\n    LoopCondition = (node, newIT) => {\n        if (!node) {\n            return \"true\";\n        } else {\n            const expr = this.compile(node.expression);\n            return node.check === \"while\" ? expr : `!${expr}`;\n        }\n    };\n\n    NoOp = (node, newIT) => {\n        return \"() => {}\";\n    };\n\n    Switch = (node, newIT) => {\n        // LOLCODE switches operate on implicit IT variable\n        // implementation quirk:\n        // you have to explicitly assign to IT on previous line\n\n        return `switch(IT) {\n            ${node.branches.map(this.compile).join(\"\\n\")}\n        };`;\n    };\n\n    Case = (node, newIT) => {\n        return `case ${this.compile(node.condition)}:\n            ${this.compile(node.body, false)}\n        `;\n    };\n\n    CaseDefault = (node, newIT) => {\n        return `default:\n            ${this.compile(node.body, false)}\n        `;\n    };\n\n    compile = (node, newIT = true) => {\n        if (this[node._name]) {\n            node = this[node._name](node, newIT);\n        } else {\n            throw new Error(`Not implemented: ${node._name}`);\n        }\n\n        return node;\n    };\n}\n\nexport default JSify;\n","/**\n * LOLCODE built in functions.\n */\nexport default {\n    NOT: function(a) {\n        return !a;\n    },\n    \"ANY OF\": function(var_args) {\n        var args = lol.utils.argsArray(arguments);\n        for (var i = 0; i < args.length; i++) {\n            if (args[i]) {\n                return true;\n            }\n        }\n        return false;\n    },\n    \"BIGGR OF\": function(a, b) {\n        return Math.max(a, b);\n    },\n    \"SMALLR OF\": function(a, b) {\n        return Math.min(a, b);\n    },\n    \"SUM OF\": function(a, b) {\n        return a + b;\n    },\n    \"DIFF OF\": function(a, b) {\n        return a - b;\n    },\n    \"PRODUKT OF\": function(a, b) {\n        return a * b;\n    },\n    \"QUOSHUNT OF\": function(a, b) {\n        return a / b;\n    },\n    \"BOTH OF\": function(a, b) {\n        return a && b;\n    },\n    \"EITHER OF\": function(a, b) {\n        return a || b;\n    },\n    \"BOTH SAEM\": function(a, b) {\n        return a === b;\n    },\n    SMOOSH: function(var_args) {\n        var args = lol.utils.argsArray(arguments);\n        return lol.utils.toYarn(\n            args.reduce(function(a, b) {\n                return lol.utils.toYarn(a) + lol.utils.toYarn(b);\n            })\n        );\n    },\n    \"BIGGR THAN\": function(a, b) {\n        return a > b;\n    },\n    \"SMALLR THAN\": function(a, b) {\n        return a < b;\n    },\n    \"MOD OF\": function(a, b) {\n        return a % b;\n    },\n    \"LEN OF\": function(a) {\n        return a && typeof a.length !== \"undefined\" ? a.length : null;\n    },\n    \"ORD OF\": function(a) {\n        return a && a.charCodeAt ? a.charCodeAt(0) : -1;\n    },\n    \"CHR OF\": function(a) {\n        return String.fromCharCode(a);\n    }\n};\n","import { createMacro } from \"babel-plugin-macros\";\nimport { parser } from \"@swizec/loljs\";\n\nimport JSify from \"./JSify\";\nimport lolstdlib from \"./lolstdlib\";\n\nconst macro = createMacro(myMacro);\nmacro.stdlib = lolstdlib;\n\nexport default macro;\n\nfunction myMacro({ references, state, babel }) {\n    references.lolcode.forEach(referencePath => {\n        const compiled = compileLolcode(referencePath);\n\n        console.log(compiled);\n        referencePath.parentPath.replaceWithSourceString(compiled);\n    });\n}\n\nfunction compileLolcode(referencePath) {\n    const source = referencePath.parentPath.node.quasi.quasis\n        .map(node => node.value.raw)\n        .join(\"\");\n\n    const ast = parser.parse(source);\n    const jsify = new JSify();\n\n    return `function () {\n       ${jsify.compile(ast)} \n    }`;\n}\n"],"names":["const","stdlib","require","JSify","Assignment","node","newIT","this","compile","value","ArgList","values","map","join","Body","lines","unshift","Break","Declaration","FunctionCall","name","args","FunctionDefinition","toLowerCase","body","Return","expression","Identifier","If","cond","condition","code","elseIfs","elseBody","Gimmeh","Visible","Literal","Loop","op","command","LoopCondition","expr","check","NoOp","Switch","branches","Case","CaseDefault","_name","Error","NOT","a","var_args","lol","utils","argsArray","arguments","i","length","b","Math","max","min","SMOOSH","toYarn","reduce","charCodeAt","String","fromCharCode","createMacro","ref","lolcode","forEach","referencePath","compiled","source","parentPath","quasi","quasis","raw","ast","parser","parse","compileLolcode","console","log","replaceWithSourceString","lolstdlib"],"mappings":"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"}